<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>XR & Creative Portfolio</title>
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <!--
      Card index for internal reference:
      1: Hero left card – "Hey, this is Tan"
      2: Hero right circular card – "Selected experiments & installations"
      3: Large flagship tile – "Mixed Reality App to Read Air Quality"
      4: About tile – "About"
      5: Project tile – "Interactive Timeline with AR features"
      6: Project tile – "Insect library in VR/MR"
      7: Project tile – "Learn about Mars in VR"
      8: Project tile – "VR Chapel"
      9: Project tile – "Workshops and Lectures"
      10: Wide tile – "An interactive archive for XR design patterns"
      11: Contact tile – "Contact & Info"
      12: Wide tile – "Process and Insights"

      Feature name – Slideshow modal (project slideshow):
      Full-screen popup with image slides, prev/next arrows, dot indicators,
      and a top-left "Project info" (i) button that opens a left-edge drawer.
      First implemented on card 3. Use this name when asking to add the same
      feature to other cards (e.g. "add the slideshow modal to card 5").
    -->
    <div class="page">
      <header class="hero">
        <div class="hero-text" id="hero-card">
          <p class="eyebrow">XR / Creative Immersive Technology</p>
          <h1>Hey, this is Tan</h1>
          <p class="tagline">
            Designing immersive, experimental worlds across extended reality and interactive media.
          </p>
        </div>
        <div class="hero-visual" id="hero-visual">
          <p class="hero-caption">Selected experiments & installations</p>
        </div>
      </header>

      <main class="bento">
        <!-- Tile 1: Flagship XXR project (2x2) -->
        <a href="#" class="tile tile-xl gradient-xxr" id="card-3">
          <div class="card3-tag-row" id="card3-tags-modal"></div>
          <h2 class="flagship-title">Mixed Reality App to Read Air Quality</h2>
          <p class="tile-body flagship-body">
            A spatial companion that visualises invisible pollution levels around you in real time.
          </p>
          <span class="tile-cta">View case study →</span>
          <div class="flagship-thumb"></div>
        </a>

        <!-- Tile 2: About / bio (1x1) – Card 4 -->
        <a href="#" class="tile tile-sm about-tile" id="card-4">
          <div class="avatar-orbit">
            <div class="avatar-circle"></div>
          </div>
          <div>
            <h3>About</h3>
            <p>
              XXR artist & creative technologist exploring presence, memory, and speculative futures.
            </p>
          </div>
        </a>

        <!-- Tile 3: Project (Card 5) -->
        <a href="#" class="tile tile-sm" id="card-5">
          <div class="thumb thumb-1"></div>
          <h3>Interactive Timeline with AR features</h3>
          <p>An AR-powered timeline that lets you scrub through stories anchored in real space.</p>
          <span class="pill-row">
            <span class="pill subtle">AR</span>
            <span class="pill subtle">Site-specific</span>
          </span>
        </a>

        <!-- Tile 4: Project (Card 6) -->
        <a href="#" class="tile tile-sm" id="card-6">
          <div class="thumb thumb-2"></div>
          <h3>Insect library in VR/MR</h3>
          <p>A living catalogue of insects you can inspect, scale, and study in mixed reality.</p>
          <span class="pill-row">
            <span class="pill subtle">Installation</span>
            <span class="pill subtle">Sound</span>
          </span>
        </a>

        <!-- Tile 5: Project (Card 7) -->
        <a href="#" class="tile tile-sm" id="card-7">
          <div class="thumb thumb-3"></div>
          <h3>Learn about Mars in VR</h3>
          <p>Guided journeys across Martian terrain, mixing scientific data with speculative futures.</p>
          <span class="pill-row">
            <span class="pill subtle">VR</span>
            <span class="pill subtle">Narrative</span>
          </span>
        </a>

        <!-- Tile 6: Process / experiments (2x1 wide) – Card 10 -->
        <a href="#" class="tile tile-wide" id="card-10">
          <div class="masonry">
            <div class="masonry-cell"></div>
            <div class="masonry-cell"></div>
            <div class="masonry-cell"></div>
            <div class="masonry-cell"></div>
          </div>
          <div class="tile-text">
            <h3>An interactive archive for XR design patterns</h3>
            <p>Reusable interaction patterns and spatial UI experiments, organised as a living library.</p>
          </div>
        </a>

        <!-- Tile 7: Project (Card 8) -->
        <a href="#" class="tile tile-sm" id="card-8">
          <div class="thumb thumb-4"></div>
          <h3>VR Chapel</h3>
          <p>An intimate virtual space for reflection, ambient rituals, and quiet gatherings.</p>
          <span class="pill-row">
            <span class="pill subtle">MR</span>
            <span class="pill subtle">Performance</span>
          </span>
        </a>

        <!-- Tile 8: Workshop / Teaching (Card 9) -->
        <a href="#" class="tile tile-sm" id="card-9">
          <div class="thumb thumb-2"></div>
          <h3>Workshops and Lectures</h3>
          <p>Sharing XR practice through talks, studio visits, and hands-on sessions.</p>
          <span class="pill-row">
            <span class="pill subtle">Teaching</span>
            <span class="pill subtle">XR</span>
          </span>
        </a>

        <!-- Tile 9: Contact / CV -->
        <a href="#" class="tile tile-sm contact-tile">
          <h3>Contact & Info</h3>
          <p>Available for collaborations, commissions, and residencies.</p>
          <ul class="contact-list">
            <li>Email · yourname@studio.xyz</li>
            <li>CV / Resume</li>
            <li>Instagram / X / Are.na</li>
          </ul>
        </a>

        <!-- Tile 10: Sketchbook (Card 12) -->
        <a href="#" class="tile tile-wide" id="card-12">
          <div class="thumb thumb-5 thumb-large"></div>
          <div class="tile-text">
            <h3>Process and Insights</h3>
            <p>
              A behind-the-scenes sketchbook of tests, notes, diagrams, and in-progress ideas that
              reveal how the work comes together.
            </p>
          </div>
        </a>
      </main>

      <div class="social-modal-overlay" id="social-modal">
        <div class="social-modal">
          <button class="social-modal-close" type="button" aria-label="Close social links">
            ✕
          </button>
          <p class="social-modal-eyebrow">Connect</p>
          <h2 class="social-modal-title">Find Tan online</h2>
          <ul class="social-modal-list">
            <li>
              <a href="https://instagram.com/" target="_blank" rel="noreferrer">
                <span class="social-label">Instagram</span>
                <span class="social-handle">@your.ig.handle</span>
              </a>
            </li>
            <li>
              <a href="https://x.com/" target="_blank" rel="noreferrer">
                <span class="social-label">X (Twitter)</span>
                <span class="social-handle">@your_x_handle</span>
              </a>
            </li>
            <li>
              <a href="https://www.linkedin.com/" target="_blank" rel="noreferrer">
                <span class="social-label">LinkedIn</span>
                <span class="social-handle">/in/your-linkedin</span>
              </a>
            </li>
          </ul>
          <a class="social-modal-cv" href="Tan-CV.pdf" download>
            <span>Download CV</span>
          </a>
        </div>
      </div>

      <div class="eni-modal-overlay" id="eni-modal">
        <div class="eni-modal">
          <button class="eni-modal-close" type="button" aria-label="Close image gallery">
            ✕
          </button>
          <p class="eni-modal-eyebrow">Image Library</p>
          <h2 class="eni-modal-title">Project snapshots</h2>
          <div class="eni-grid" id="eni-grid"></div>
        </div>
      </div>

      <div class="card3-modal-overlay" id="card3-modal">
        <div class="card3-modal">
          <button class="card3-modal-close" type="button" aria-label="Close project slideshow">
            ✕
          </button>
          <div class="card3-tag-row">
            <span class="pill subtle">WebXR</span>
            <span class="pill subtle">Environmental Data</span>
            <span class="pill subtle">three.js</span>
          </div>
          <div class="card3-slide-meta">
            <h2 id="card3-slide-title"></h2>
            <p id="card3-slide-subtitle"></p>
          </div>
          <div class="card3-slide-frame">
            <img id="card3-slide-image" class="card3-slide-image" src="" alt="" loading="lazy" />
            <button class="card3-nav card3-nav-prev" type="button" aria-label="Previous slide">
              ‹
            </button>
            <button class="card3-nav card3-nav-next" type="button" aria-label="Next slide">
              ›
            </button>
            <div class="card3-dots" id="card3-dots"></div>
          </div>
          <div class="card3-bottom-meta">
            <div class="card3-bottom-meta-item">
              <span class="card3-bottom-label">Year</span>
              <span class="card3-bottom-value" id="card3-year"></span>
            </div>
            <div class="card3-bottom-meta-item">
              <span class="card3-bottom-label">Role</span>
              <span class="card3-bottom-value" id="card3-role"></span>
            </div>
            <div class="card3-bottom-meta-item">
              <span class="card3-bottom-label">Tools</span>
              <span class="card3-bottom-value" id="card3-tools"></span>
            </div>
          </div>
        </div>
      </div>

      <div class="link-confirm-overlay" id="link-confirm-modal">
        <div class="link-confirm-modal">
          <button class="link-confirm-close" type="button" aria-label="Close">✕</button>
          <p class="link-confirm-message">This link will open in a new tab.</p>
          <div class="link-confirm-actions">
            <button type="button" class="link-confirm-cancel">Cancel</button>
            <button type="button" class="link-confirm-open">Open in new tab</button>
          </div>
        </div>
      </div>
    </div>
    <script>
      (function () {
        const heroCard = document.getElementById("hero-card");
        const socialModal = document.getElementById("social-modal");
        const heroCircle = document.getElementById("hero-visual");
        const eniModal = document.getElementById("eni-modal");
        const card3Modal = document.getElementById("card3-modal");
        const card3Tile = document.getElementById("card-3");
        const card5Tile = document.getElementById("card-5");
        const card6Tile = document.getElementById("card-6");
        const card7Tile = document.getElementById("card-7");
        const card8Tile = document.getElementById("card-8");
        const card9Tile = document.getElementById("card-9");
        const card10Tile = document.getElementById("card-10");
        if (!heroCard || !socialModal || !heroCircle || !eniModal || !card3Modal)
          return;

        const socialCloseBtn = socialModal.querySelector(".social-modal-close");
        const eniCloseBtn = eniModal.querySelector(".eni-modal-close");
        const eniGrid = document.getElementById("eni-grid");
        let eniLoaded = false;
        const card3CloseBtn = card3Modal.querySelector(".card3-modal-close");
        const card3ImageEl = document.getElementById("card3-slide-image");
        const card3TitleEl = document.getElementById("card3-slide-title");
        const card3SubtitleEl = document.getElementById("card3-slide-subtitle");
        const card3PrevBtn = card3Modal.querySelector(".card3-nav-prev");
        const card3NextBtn = card3Modal.querySelector(".card3-nav-next");
        const card3DotsEl = card3Modal.querySelector("#card3-dots");
        const card3ModalTagsEl = document.getElementById("card3-tags-modal");
        const card3YearEl = document.getElementById("card3-year");
        const card3RoleEl = document.getElementById("card3-role");
        const card3ToolsEl = document.getElementById("card3-tools");
        const linkConfirmModal = document.getElementById("link-confirm-modal");
        const linkConfirmCloseBtn = linkConfirmModal && linkConfirmModal.querySelector(".link-confirm-close");
        const linkConfirmCancelBtn = linkConfirmModal && linkConfirmModal.querySelector(".link-confirm-cancel");
        const linkConfirmOpenBtn = linkConfirmModal && linkConfirmModal.querySelector(".link-confirm-open");
        let pendingLinkUrl = null;
        let indexImagesCache = null;
        let card3Slides = [];
        let card3SlideIndex = 0;
        let activeCardId = 3;

        function openSocialModal() {
          socialModal.classList.add("is-open");
          document.body.style.overflow = "hidden";
        }

        function closeSocialModal() {
          socialModal.classList.remove("is-open");
          document.body.style.overflow = "";
        }

        function openEniModal() {
          eniModal.classList.add("is-open");
          document.body.style.overflow = "hidden";
          if (!eniLoaded) {
            loadEniImages();
          }
        }

        function closeEniModal() {
          eniModal.classList.remove("is-open");
          document.body.style.overflow = "";
        }

        function openCardModal(cardId, event) {
          if (event) event.preventDefault();
          activeCardId = cardId;
          card3SlideIndex = 0;
          card3Modal.classList.add("is-open");
          document.body.style.overflow = "hidden";
          populateCard3Modal();
        }

        function closeCard3Modal() {
          card3Modal.classList.remove("is-open");
          document.body.style.overflow = "";
        }

        function openLinkConfirmModal(href) {
          pendingLinkUrl = href;
          if (linkConfirmModal) {
            linkConfirmModal.classList.add("is-open");
            document.body.style.overflow = "hidden";
          }
        }

        function closeLinkConfirmModal() {
          pendingLinkUrl = null;
          if (linkConfirmModal) {
            linkConfirmModal.classList.remove("is-open");
            document.body.style.overflow = "";
          }
        }

        if (linkConfirmModal) {
          linkConfirmModal.addEventListener("click", (e) => {
            if (e.target === linkConfirmModal) closeLinkConfirmModal();
          });
        }
        if (linkConfirmCloseBtn) linkConfirmCloseBtn.addEventListener("click", closeLinkConfirmModal);
        if (linkConfirmCancelBtn) linkConfirmCancelBtn.addEventListener("click", closeLinkConfirmModal);
        if (linkConfirmOpenBtn) {
          linkConfirmOpenBtn.addEventListener("click", () => {
            if (pendingLinkUrl) {
              window.open(pendingLinkUrl, "_blank", "noopener,noreferrer");
            }
            closeLinkConfirmModal();
          });
        }

        heroCard.addEventListener("click", openSocialModal);
        heroCircle.addEventListener("click", openEniModal);
        if (card3Tile) {
          card3Tile.addEventListener("click", (e) => openCardModal(3, e));
        }
        if (card5Tile) {
          card5Tile.addEventListener("click", (e) => openCardModal(5, e));
        }
        if (card6Tile) {
          card6Tile.addEventListener("click", (e) => openCardModal(6, e));
        }
        if (card7Tile) {
          card7Tile.addEventListener("click", (e) => openCardModal(7, e));
        }
        if (card8Tile) {
          card8Tile.addEventListener("click", (e) => openCardModal(8, e));
        }
        if (card9Tile) {
          card9Tile.addEventListener("click", (e) => openCardModal(9, e));
        }

        socialModal.addEventListener("click", (event) => {
          if (event.target === socialModal) {
            closeSocialModal();
          }
        });

        eniModal.addEventListener("click", (event) => {
          if (event.target === eniModal) {
            closeEniModal();
          }
        });

        card3Modal.addEventListener("click", (event) => {
          if (event.target === card3Modal) {
            closeCard3Modal();
          }
        });

        if (socialCloseBtn) {
          socialCloseBtn.addEventListener("click", closeSocialModal);
        }

        if (eniCloseBtn) {
          eniCloseBtn.addEventListener("click", closeEniModal);
        }

        if (card3CloseBtn) {
          card3CloseBtn.addEventListener("click", closeCard3Modal);
        }

        if (card3PrevBtn) {
          card3PrevBtn.addEventListener("click", function (e) {
            e.stopPropagation();
            stepCard3Slide(-1);
          });
        }

        if (card3NextBtn) {
          card3NextBtn.addEventListener("click", function (e) {
            e.stopPropagation();
            stepCard3Slide(1);
          });
        }

        window.addEventListener("keydown", (event) => {
            if (event.key === "Escape") {
            if (socialModal.classList.contains("is-open")) {
              closeSocialModal();
            }
            if (eniModal.classList.contains("is-open")) {
              closeEniModal();
            }
            if (card3Modal.classList.contains("is-open")) {
              closeCard3Modal();
            }
            if (linkConfirmModal && linkConfirmModal.classList.contains("is-open")) {
              closeLinkConfirmModal();
            }
          }
        });

        // Load index_content.json for card-specific imagery and text
        loadIndexImages();

        function loadEniImages() {
          if (!eniGrid) return;
          fetch("eni_images.json")
            .then((res) => res.json())
            .then((items) => {
              if (!Array.isArray(items)) return;
              eniGrid.innerHTML = "";
              items.forEach((item) => {
                const card = document.createElement("a");
                card.className = "eni-card";
                card.href = item.link || "#";
                if ((item.link || "#").startsWith("http")) {
                  card.target = "_blank";
                  card.rel = "noreferrer";
                }
                const title = item.title || "";
                const id = item.id || "";
                card.innerHTML = `
                  <img class="eni-thumb" src="${item.src}" alt="${title}" loading="lazy" />
                  <div class="eni-body">
                    <p class="eni-title">${title}</p>
                    <p class="eni-id">#${id}</p>
                  </div>
                `;
                eniGrid.appendChild(card);
              });
              eniLoaded = true;
            })
            .catch(() => {
              eniGrid.innerHTML = "<p class='eni-error'>Could not load images yet.</p>";
            });
        }

        function loadIndexImages() {
          fetch("index_content.json")
            .then((res) => res.json())
            .then((items) => {
              if (!Array.isArray(items)) return;
              indexImagesCache = items;
              items.forEach((item) => {
                if (!item || typeof item.card === "undefined") return;

                if (item.card === 3) {
                  const flagshipTile = document.getElementById("card-3");
                  if (flagshipTile) {
                    const thumb = flagshipTile.querySelector(".flagship-thumb");
                    const titleEl = flagshipTile.querySelector(".flagship-title");
                    const bodyEl = flagshipTile.querySelector(".flagship-body");
                    const homepageTagRow = flagshipTile.querySelector(".card3-tag-row");

                    if (thumb && item.src) {
                      thumb.style.backgroundImage = "url('" + item.src + "')";
                    }
                    if (titleEl && item.title) {
                      titleEl.textContent = item.title;
                    }
                    if (bodyEl && item.subtitle) {
                      bodyEl.textContent = item.subtitle;
                    }

                    if (homepageTagRow && Array.isArray(item.tags)) {
                      homepageTagRow.innerHTML = "";
                      item.tags.forEach((tag) => {
                        const span = document.createElement("span");
                        span.className = "pill subtle";
                        span.textContent = tag;
                        homepageTagRow.appendChild(span);
                      });
                    }
                  }

                  return;
                }

                if (item.card === 4) {
                  const aboutTile = document.getElementById("card-4");
                  if (aboutTile) {
                    aboutTile.href = item.link || "#";
                    if (item.link) {
                      aboutTile.target = "_blank";
                      aboutTile.rel = "noreferrer";
                      aboutTile.addEventListener("click", function (e) {
                        e.preventDefault();
                        openLinkConfirmModal(aboutTile.href);
                      });
                    }
                    const titleEl = aboutTile.querySelector("h3");
                    const bodyEl = aboutTile.querySelector("p");
                    if (titleEl && item.title) titleEl.textContent = item.title;
                    if (bodyEl && item.subtitle) bodyEl.textContent = item.subtitle;
                  }
                  return;
                }

                // Cards 5, 6, 7, 8, 9, 10, 12 – homepage tiles
                const tile = document.getElementById("card-" + item.card);
                if (!tile) return;

                const titleEl = tile.querySelector("h3");
                const bodyEl = tile.querySelector("p");
                const thumbEl = tile.querySelector(".thumb, .thumb-large");
                const pillRow = tile.querySelector(".pill-row");

                // Special handling for card 10 mosaic: apply image into each masonry cell
                if (item.card === 10) {
                  const masonry = tile.querySelector(".masonry");
                  if (masonry) {
                    const cells = masonry.querySelectorAll(".masonry-cell");
                    const mosaicImages =
                      Array.isArray(item.mosaic) && item.mosaic.length > 0
                        ? item.mosaic
                        : Array.isArray(item.slides) && item.slides.length > 0
                          ? item.slides
                          : [item.src];
                    cells.forEach((cell, idx) => {
                      const src = mosaicImages[idx % mosaicImages.length];
                      cell.style.backgroundImage = "url('" + src + "')";
                      cell.style.backgroundSize = "cover";
                      cell.style.backgroundPosition = "center";
                      cell.style.backgroundRepeat = "no-repeat";
                    });
                  }
                }

                if (thumbEl && item.src) {
                  thumbEl.style.backgroundImage = "url('" + item.src + "')";
                  thumbEl.style.backgroundSize = "cover";
                  thumbEl.style.backgroundPosition = "center";
                }
                if (titleEl && item.title) {
                  titleEl.textContent = item.title;
                }
                if (bodyEl && item.subtitle) {
                  bodyEl.textContent = item.subtitle;
                }

                if (pillRow && Array.isArray(item.tags)) {
                  pillRow.innerHTML = "";
                  item.tags.forEach((tag) => {
                    const span = document.createElement("span");
                    span.className = "pill subtle";
                    span.textContent = tag;
                    pillRow.appendChild(span);
                  });
                }
                if (item.link) {
                  tile.href = item.link;
                  tile.target = "_blank";
                  tile.rel = "noreferrer";
                  tile.addEventListener("click", function (e) {
                    e.preventDefault();
                    openLinkConfirmModal(tile.href);
                  });
                }
              });
            })
            .catch(() => {
              // silently fail if JSON can't be loaded
            });
        }

        function populateCard3Modal() {
          if (!indexImagesCache) return;
          const cardData = indexImagesCache.find((item) => item.card === activeCardId);
          if (!cardData) return;

          if (Array.isArray(cardData.slides) && cardData.slides.length > 0) {
            card3Slides = cardData.slides;
          } else if (cardData.src) {
            card3Slides = [cardData.src];
          } else {
            card3Slides = [];
          }
          card3SlideIndex = 0;
          buildCard3Dots();
          showCard3Slide(0);

          if (card3TitleEl && cardData.title) {
            card3TitleEl.textContent = cardData.title;
          }
          if (card3SubtitleEl && cardData.subtitle) {
            card3SubtitleEl.textContent = cardData.subtitle;
          }

          if (card3ModalTagsEl && Array.isArray(cardData.tags)) {
            card3ModalTagsEl.innerHTML = "";
            cardData.tags.forEach((tag) => {
              const span = document.createElement("span");
              span.className = "pill subtle";
              span.textContent = tag;
              card3ModalTagsEl.appendChild(span);
            });
          }

          if (card3YearEl && typeof cardData.year !== "undefined") {
            card3YearEl.textContent = String(cardData.year);
          }
          if (card3RoleEl && cardData.role) {
            card3RoleEl.textContent = cardData.role;
          }
          if (card3ToolsEl && cardData.tools) {
            card3ToolsEl.textContent = cardData.tools;
          }
        }

        function showCard3Slide(index) {
          if (!card3ImageEl || card3Slides.length === 0) return;
          const safeIndex = ((index % card3Slides.length) + card3Slides.length) % card3Slides.length;
          card3SlideIndex = safeIndex;
          const src = card3Slides[safeIndex];
          card3ImageEl.src = src;
          updateCard3Dots();
        }

        function stepCard3Slide(delta) {
          showCard3Slide((card3SlideIndex || 0) + delta);
        }

        function buildCard3Dots() {
          if (!card3DotsEl) return;
          card3DotsEl.innerHTML = "";
          card3Slides.forEach((_, i) => {
            const dot = document.createElement("button");
            dot.type = "button";
            dot.className = "card3-dot";
            dot.addEventListener("click", function (e) {
              e.stopPropagation();
              showCard3Slide(i);
            });
            card3DotsEl.appendChild(dot);
          });
          updateCard3Dots();
        }

        function updateCard3Dots() {
          if (!card3DotsEl) return;
          const dots = card3DotsEl.querySelectorAll(".card3-dot");
          dots.forEach((dot, i) => {
            dot.classList.toggle("is-active", i === card3SlideIndex);
          });
        }
      })();
    </script>
  </body>
</html>

